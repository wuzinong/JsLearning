!function(n,e){for(var t in e)n[t]=e[t]}(exports,function(n){var e={};function t(r){if(e[r])return e[r].exports;var o=e[r]={i:r,l:!1,exports:{}};return n[r].call(o.exports,o,o.exports,t),o.l=!0,o.exports}return t.m=n,t.c=e,t.d=function(n,e,r){t.o(n,e)||Object.defineProperty(n,e,{enumerable:!0,get:r})},t.r=function(n){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(n,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(n,"__esModule",{value:!0})},t.t=function(n,e){if(1&e&&(n=t(n)),8&e)return n;if(4&e&&"object"==typeof n&&n&&n.__esModule)return n;var r=Object.create(null);if(t.r(r),Object.defineProperty(r,"default",{enumerable:!0,value:n}),2&e&&"string"!=typeof n)for(var o in n)t.d(r,o,function(e){return n[e]}.bind(null,o));return r},t.n=function(n){var e=n&&n.__esModule?function(){return n.default}:function(){return n};return t.d(e,"a",e),e},t.o=function(n,e){return Object.prototype.hasOwnProperty.call(n,e)},t.p="",t(t.s=1)}([function(n,e){n.exports=require("domain")},function(n,e,t){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=t(2);e.default=r.createServerRenderer(function(n){return new Promise(function(e,t){e({html:"<h1>This is rendered from server</h1>\n                     <div>Current time:"+new Date+"</div>\n                     <div>URL:"+n.location.path+"</div>\n                     <div>IsAdministrator:"+n.data.isAdministrator+"</div>\n                     <div>Number of Cookies:"+n.data.cookies.length+"</div>\n                "})})})},function(n,e,t){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),function(n){for(var t in n)e.hasOwnProperty(t)||(e[t]=n[t])}(t(3))},function(n,e,t){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=t(4),o=t(0),u=t(5),i=3e4;e.createServerRenderer=function(n){var e=function(e,t,c,a,l,s,f,d){var _,m=new Promise(function(n,e){_=n}),v=r.parse(a),p={location:r.parse(l,!0),origin:v.protocol+"//"+v.host,url:l,baseUrl:(d||"")+"/",absoluteUrl:a,domainTasks:m,data:s},b=p.origin+p.baseUrl;u.run(function(){!function(n,e){var t=n.then;n.then=function(n,r){return"function"==typeof n&&(n=e.bind(n)),"function"==typeof r&&(r=e.bind(r)),t.call(this,n,r)}}(m,o.active),u.baseUrl(b);var t=n(p);if(t&&"function"==typeof t.then){var r=f||i;(r>0?function(n,e,t){return new Promise(function(r,o){var u=setTimeout(function(){o(t)},e);n.then(function(n){clearTimeout(u),r(n)},function(n){clearTimeout(u),o(n)})})}(t,r,"Prerendering timed out after "+r+"ms because the boot function in '"+c.moduleName+"' returned a promise that did not resolve or reject. Make sure that your boot function always resolves or rejects its promise. You can change the timeout value using the 'asp-prerender-timeout' tag helper."):t).then(function(n){e(null,n)},function(n){e(n,null)})}else e("Prerendering failed because the boot function in "+c.moduleName+" did not return a promise.",null)},function(n){n?e(n,null):_()})};return e.isServerRenderer=!0,e}},function(n,e){n.exports=require("url")},function(n,e,t){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r,o=t(0),u=t(6),i="__DOMAIN_TASKS",c="__DOMAIN_TASK_INTERNAL_FETCH_BASEURL__DO_NOT_REFERENCE_THIS__";e.addTask=function(n){if(n&&o.active){var e=u.get(i);e&&(e.numRemainingTasks++,n.then(function(){setTimeout(function(){e.numRemainingTasks--,0!==e.numRemainingTasks||e.hasIssuedSuccessCallback||(e.hasIssuedSuccessCallback=!0,setTimeout(function(){e.completionCallback(null)},0))},0)},function(n){e.completionCallback(n)}))}},e.run=function(n,e){var t;return u.runInNewDomain(function(){var r={numRemainingTasks:0,hasIssuedSuccessCallback:!1,completionCallback:o.active.bind(e)};try{u.set(i,r),t=n(),0!==r.numRemainingTasks||r.hasIssuedSuccessCallback||(r.hasIssuedSuccessCallback=!0,setTimeout(function(){r.completionCallback(null)},0))}catch(n){r.completionCallback(n)}}),t},e.baseUrl=function(n){return n&&(o.active?u.set(c,n):r=n),o.active?u.get(c):r}},function(n,e,t){var r;r=t(0),e.context=function(n,e){if(null==e&&(e=r.active),null==e)throw new Error("no active domain");return e.__context__=null!=n?n():{}},e.cleanup=function(n,e,t){if(null==e&&(e=null),null==t&&(t=r.active),e=e||t.__context__,null!=n&&null!=e&&n(e),null!=t)return t.__context__=null},e.onError=function(n,e,t,o){return null==t&&(t=null),null==o&&(o=r.active),t=t||o.__context__,null!=e&&e(n,t),o.__context__=null},e.get=function(n,e){if(null==e&&(e=r.active),null==e)throw new Error("no active domain");return e.__context__[n]},e.set=function(n,e,t){if(null==t&&(t=r.active),null==t)throw new Error("no active domain");return t.__context__[n]=e},e.run=function(n,t){var o,u,i,c,a;if(t||(t=n,n={}),u=n.context,o=n.cleanup,a=n.onError,!(i=n.domain||r.active))throw new Error("no active domain");i.on("dispose",function(){return e.cleanup(o,null,i)}),i.on("error",function(n){return null!=a?e.onError(n,a,null,i):e.cleanup(o,null,i)}),e.context(u,i);try{i.bind(t,!0)()}catch(n){c=n,i.emit("error",c)}return i},e.runInNewDomain=function(n,t){var o;return t||(t=n,n={}),o=r.active,n.domain=r.create(),!n.detach&&o&&(o.add(n.domain),n.domain.on("error",function(n){return o.emit("error",n)}),o.on("dispose",function(){return n.domain.dispose()})),e.run(n,t)},e.middleware=function(n,t){return function(o,u,i){var c,a;return"function"!=typeof n&&(n=(a=n).context,t=a.cleanup),c=r.active,e.context(n,c),u.on("finish",function(){return e.cleanup(t,null,c)}),o.__context__=c.__context__,i()}},e.middlewareOnError=function(n){return function(t,r,o,u){return"function"!=typeof n&&(n=n.onError),null!=n?e.onError(t,n,r.__context__):e.cleanup(n,r.__context__),r.__context__=null,u(t)}}}]));
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly8vd2VicGFjay9ib290c3RyYXAiLCJ3ZWJwYWNrOi8vL2V4dGVybmFsIFwiZG9tYWluXCIiLCJ3ZWJwYWNrOi8vLy4vQ2xpZW50QXBwL2Jvb3Qtc2VydmVyLnRzIiwid2VicGFjazovLy8uL25vZGVfbW9kdWxlcy9hc3BuZXQtcHJlcmVuZGVyaW5nL2luZGV4LmpzIiwid2VicGFjazovLy8uL25vZGVfbW9kdWxlcy9hc3BuZXQtcHJlcmVuZGVyaW5nL1ByZXJlbmRlcmluZy5qcyIsIndlYnBhY2s6Ly8vZXh0ZXJuYWwgXCJ1cmxcIiIsIndlYnBhY2s6Ly8vLi9ub2RlX21vZHVsZXMvZG9tYWluLXRhc2svbWFpbi5qcyIsIndlYnBhY2s6Ly8vLi9ub2RlX21vZHVsZXMvZG9tYWluLWNvbnRleHQvbGliL2luZGV4LmpzIl0sIm5hbWVzIjpbImluc3RhbGxlZE1vZHVsZXMiLCJfX3dlYnBhY2tfcmVxdWlyZV9fIiwibW9kdWxlSWQiLCJleHBvcnRzIiwibW9kdWxlIiwiaSIsImwiLCJtb2R1bGVzIiwiY2FsbCIsIm0iLCJjIiwiZCIsIm5hbWUiLCJnZXR0ZXIiLCJvIiwiT2JqZWN0IiwiZGVmaW5lUHJvcGVydHkiLCJlbnVtZXJhYmxlIiwiZ2V0IiwiciIsIlN5bWJvbCIsInRvU3RyaW5nVGFnIiwidmFsdWUiLCJ0IiwibW9kZSIsIl9fZXNNb2R1bGUiLCJucyIsImNyZWF0ZSIsImtleSIsImJpbmQiLCJuIiwib2JqZWN0IiwicHJvcGVydHkiLCJwcm90b3R5cGUiLCJoYXNPd25Qcm9wZXJ0eSIsInAiLCJzIiwicmVxdWlyZSIsImFzcG5ldF9wcmVyZW5kZXJpbmdfMSIsImRlZmF1bHQiLCJjcmVhdGVTZXJ2ZXJSZW5kZXJlciIsInBhcmFtcyIsIlByb21pc2UiLCJyZXNvbHZlIiwicmVqZWN0IiwiaHRtbCIsIkRhdGUiLCJsb2NhdGlvbiIsInBhdGgiLCJkYXRhIiwiaXNBZG1pbmlzdHJhdG9yIiwiY29va2llcyIsImxlbmd0aCIsIl9fZXhwb3J0IiwidXJsIiwiZG9tYWluIiwibWFpbl8xIiwiZGVmYXVsdFRpbWVvdXRNaWxsaXNlY29uZHMiLCJib290RnVuYyIsInJlc3VsdEZ1bmMiLCJjYWxsYmFjayIsImFwcGxpY2F0aW9uQmFzZVBhdGgiLCJib290TW9kdWxlIiwiYWJzb2x1dGVSZXF1ZXN0VXJsIiwicmVxdWVzdFBhdGhBbmRRdWVyeSIsImN1c3RvbURhdGFQYXJhbWV0ZXIiLCJvdmVycmlkZVRpbWVvdXRNaWxsaXNlY29uZHMiLCJyZXF1ZXN0UGF0aEJhc2UiLCJkb21haW5UYXNrQ29tcGxldGlvblByb21pc2VSZXNvbHZlIiwiZG9tYWluVGFza0NvbXBsZXRpb25Qcm9taXNlIiwicGFyc2VkQWJzb2x1dGVSZXF1ZXN0VXJsIiwicGFyc2UiLCJvcmlnaW4iLCJwcm90b2NvbCIsImhvc3QiLCJiYXNlVXJsIiwiYWJzb2x1dGVVcmwiLCJkb21haW5UYXNrcyIsImFic29sdXRlQmFzZVVybCIsInJ1biIsInByb21pc2UiLCJkb21haW5JbnN0YW5jZSIsIm9yaWdpbmFsVGhlbiIsInRoZW4iLCJ0aGlzIiwiYmluZFByb21pc2VDb250aW51YXRpb25zVG9Eb21haW4iLCJib290RnVuY1Byb21pc2UiLCJ0aW1lb3V0TWlsbGlzZWNvbmRzIiwidGltZW91dFJlamVjdGlvblZhbHVlIiwidGltZW91dFRpbWVyIiwic2V0VGltZW91dCIsInJlc29sdmVkVmFsdWUiLCJjbGVhclRpbWVvdXQiLCJyZWplY3RlZFZhbHVlIiwid3JhcFdpdGhUaW1lb3V0IiwibW9kdWxlTmFtZSIsInN1Y2Nlc3NSZXN1bHQiLCJlcnJvciIsImVycm9yT3JOb3RoaW5nIiwibm9Eb21haW5CYXNlVXJsIiwiZG9tYWluQ29udGV4dCIsImRvbWFpblRhc2tzU3RhdGVLZXkiLCJkb21haW5UYXNrQmFzZVVybFN0YXRlS2V5IiwiYWRkVGFzayIsInRhc2siLCJhY3RpdmUiLCJzdGF0ZV8xIiwibnVtUmVtYWluaW5nVGFza3MiLCJoYXNJc3N1ZWRTdWNjZXNzQ2FsbGJhY2siLCJjb21wbGV0aW9uQ2FsbGJhY2siLCJjb2RlVG9SdW4iLCJzeW5jaHJvbm91c1Jlc3VsdCIsInJ1bkluTmV3RG9tYWluIiwic3RhdGUiLCJzZXQiLCJleCIsImNvbnRleHQiLCJjdXJyZW50RG9tYWluIiwiRXJyb3IiLCJfX2NvbnRleHRfXyIsImNsZWFudXAiLCJvbkVycm9yIiwiZXJyIiwib3B0aW9ucyIsImZ1bmMiLCJvbiIsIl9lcnJvciIsImVtaXQiLCJkZXRhY2giLCJhZGQiLCJkaXNwb3NlIiwibWlkZGxld2FyZSIsInJlcSIsInJlcyIsIm5leHQiLCJfcmVmIiwibWlkZGxld2FyZU9uRXJyb3IiXSwibWFwcGluZ3MiOiI2REFDQSxJQUFBQSxLQUdBLFNBQUFDLEVBQUFDLEdBR0EsR0FBQUYsRUFBQUUsR0FDQSxPQUFBRixFQUFBRSxHQUFBQyxRQUdBLElBQUFDLEVBQUFKLEVBQUFFLElBQ0FHLEVBQUFILEVBQ0FJLEdBQUEsRUFDQUgsWUFVQSxPQU5BSSxFQUFBTCxHQUFBTSxLQUFBSixFQUFBRCxRQUFBQyxJQUFBRCxRQUFBRixHQUdBRyxFQUFBRSxHQUFBLEVBR0FGLEVBQUFELFFBMERBLE9BckRBRixFQUFBUSxFQUFBRixFQUdBTixFQUFBUyxFQUFBVixFQUdBQyxFQUFBVSxFQUFBLFNBQUFSLEVBQUFTLEVBQUFDLEdBQ0FaLEVBQUFhLEVBQUFYLEVBQUFTLElBQ0FHLE9BQUFDLGVBQUFiLEVBQUFTLEdBQTBDSyxZQUFBLEVBQUFDLElBQUFMLEtBSzFDWixFQUFBa0IsRUFBQSxTQUFBaEIsR0FDQSxvQkFBQWlCLGVBQUFDLGFBQ0FOLE9BQUFDLGVBQUFiLEVBQUFpQixPQUFBQyxhQUF3REMsTUFBQSxXQUV4RFAsT0FBQUMsZUFBQWIsRUFBQSxjQUFpRG1CLE9BQUEsS0FRakRyQixFQUFBc0IsRUFBQSxTQUFBRCxFQUFBRSxHQUVBLEdBREEsRUFBQUEsSUFBQUYsRUFBQXJCLEVBQUFxQixJQUNBLEVBQUFFLEVBQUEsT0FBQUYsRUFDQSxLQUFBRSxHQUFBLGlCQUFBRixRQUFBRyxXQUFB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QSxHQUFBbUIsRUFBQW5CLFdBQUFJLEVBQUFlLEVBQUFmLFNBRUFILEVBQUE5RCxFQUFBa0QsT0FDQXRHLEVBQUFpSCxVQUFBQyxHQUNBZ0IsRUFBQVIsR0FBQSxvQkFDQSxPQUFBMUgsRUFBQXFILFVBQUEsS0FBQUgsS0FFQWUsRUFBQWIsWUFBQUYsRUFBQUUsWUFDQWUsTUFJQW5JLEVBQUFxSSxrQkFBQSxTQUFBZixHQUNBLGdCQUFBQyxFQUFBVSxFQUFBQyxFQUFBQyxHQVVBLE1BVEEsbUJBQUFiLElBQ0FBLGFBRUEsTUFBQUEsRUFDQXRILEVBQUFzSCxRQUFBQyxFQUFBRCxFQUFBVyxFQUFBYixhQUVBcEgsRUFBQXFILFFBQUFDLEVBQUFXLEVBQUFiLGFBRUFhLEVBQUFiLFlBQUEsS0FDQWUsRUFBQVoiLCJmaWxlIjoibWFpbi1zZXJ2ZXIuanMiLCJzb3VyY2VzQ29udGVudCI6WyIgXHQvLyBUaGUgbW9kdWxlIGNhY2hlXG4gXHR2YXIgaW5zdGFsbGVkTW9kdWxlcyA9IHt9O1xuXG4gXHQvLyBUaGUgcmVxdWlyZSBmdW5jdGlvblxuIFx0ZnVuY3Rpb24gX193ZWJwYWNrX3JlcXVpcmVfXyhtb2R1bGVJZCkge1xuXG4gXHRcdC8vIENoZWNrIGlmIG1vZHVsZSBpcyBpbiBjYWNoZVxuIFx0XHRpZihpbnN0YWxsZWRNb2R1bGVzW21vZHVsZUlkXSkge1xuIFx0XHRcdHJldHVybiBpbnN0YWxsZWRNb2R1bGVzW21vZHVsZUlkXS5leHBvcnRzO1xuIFx0XHR9XG4gXHRcdC8vIENyZWF0ZSBhIG5ldyBtb2R1bGUgKGFuZCBwdXQgaXQgaW50byB0aGUgY2FjaGUpXG4gXHRcdHZhciBtb2R1bGUgPSBpbnN0YWxsZWRNb2R1bGVzW21vZHVsZUlkXSA9IHtcbiBcdFx0XHRpOiBtb2R1bGVJZCxcbiBcdFx0XHRsOiBmYWxzZSxcbiBcdFx0XHRleHBvcnRzOiB7fVxuIFx0XHR9O1xuXG4gXHRcdC8vIEV4ZWN1dGUgdGhlIG1vZHVsZSBmdW5jdGlvblxuIFx0XHRtb2R1bGVzW21vZHVsZUlkXS5jYWxsKG1vZHVsZS5leHBvcnRzLCBtb2R1bGUsIG1vZHVsZS5leHBvcnRzLCBfX3dlYnBhY2tfcmVxdWlyZV9fKTtcblxuIFx0XHQvLyBGbGFnIHRoZSBtb2R1bGUgYXMgbG9hZGVkXG4gXHRcdG1vZHVsZS5sID0gdHJ1ZTtcblxuIFx0XHQvLyBSZXR1cm4gdGhlIGV4cG9ydHMgb2YgdGhlIG1vZHVsZVxuIFx0XHRyZXR1cm4gbW9kdWxlLmV4cG9ydHM7XG4gXHR9XG5cblxuIFx0Ly8gZXhwb3NlIHRoZSBtb2R1bGVzIG9iamVjdCAoX193ZWJwYWNrX21vZHVsZXNfXylcbiBcdF9fd2VicGFja19yZXF1aXJlX18ubSA9IG1vZHVsZXM7XG5cbiBcdC8vIGV4cG9zZSB0aGUgbW9kdWxlIGNhY2hlXG4gXHRfX3dlYnBhY2tfcmVxdWlyZV9fLmMgPSBpbnN0YWxsZWRNb2R1bGVzO1xuXG4gXHQvLyBkZWZpbmUgZ2V0dGVyIGZ1bmN0aW9uIGZvciBoYXJtb255IGV4cG9ydHNcbiBcdF9fd2VicGFja19yZXF1aXJlX18uZCA9IGZ1bmN0aW9uKGV4cG9ydHMsIG5hbWUsIGdldHRlcikge1xuIFx0XHRpZighX193ZWJwYWNrX3JlcXVpcmVfXy5vKGV4cG9ydHMsIG5hbWUpKSB7XG4gXHRcdFx0T2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsIG5hbWUsIHsgZW51bWVyYWJsZTogdHJ1ZSwgZ2V0OiBnZXR0ZXIgfSk7XG4gXHRcdH1cbiBcdH07XG5cbiBcdC8vIGRlZmluZSBfX2VzTW9kdWxlIG9uIGV4cG9ydHNcbiBcdF9fd2VicGFja19yZXF1aXJlX18uciA9IGZ1bmN0aW9uKGV4cG9ydHMpIHtcbiBcdFx0aWYodHlwZW9mIFN5bWJvbCAhPT0gJ3VuZGVmaW5lZCcgJiYgU3ltYm9sLnRvU3RyaW5nVGFnKSB7XG4gXHRcdFx0T2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsIFN5bWJvbC50b1N0cmluZ1RhZywgeyB2YWx1ZTogJ01vZHVsZScgfSk7XG4gXHRcdH1cbiBcdFx0T2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsICdfX2VzTW9kdWxlJywgeyB2YWx1ZTogdHJ1ZSB9KTtcbiBcdH07XG5cbiBcdC8vIGNyZWF0ZSBhIGZha2UgbmFtZXNwYWNlIG9iamVjdFxuIFx0Ly8gbW9kZSAmIDE6IHZhbHVlIGlzIGEgbW9kdWxlIGlkLCByZXF1aXJlIGl0XG4gXHQvLyBtb2RlICYgMjogbWVyZ2UgYWxsIHByb3BlcnRpZXMgb2YgdmFsdWUgaW50byB0aGUgbnNcbiBcdC8vIG1vZGUgJiA0OiByZXR1cm4gdmFsdWUgd2hlbiBhbHJlYWR5IG5zIG9iamVjdFxuIFx0Ly8gbW9kZSAmIDh8MTogYmVoYXZlIGxpa2UgcmVxdWlyZVxuIFx0X193ZWJwYWNrX3JlcXVpcmVfXy50ID0gZnVuY3Rpb24odmFsdWUsIG1vZGUpIHtcbiBcdFx0aWYobW9kZSAmIDEpIHZhbHVlID0gX193ZWJwYWNrX3JlcXVpcmVfXyh2YWx1ZSk7XG4gXHRcdGlmKG1vZGUgJiA4KSByZXR1cm4gdmFsdWU7XG4gXHRcdGlmKChtb2RlICYgNCkgJiYgdHlwZW9mIHZhbHVlID09PSAnb2JqZWN0JyAmJiB2YWx1ZSAmJiB2YWx1ZS5fX2VzTW9kdWxlKSByZXR1cm4gdmFsdWU7XG4gXHRcdHZhciBucyA9IE9iamVjdC5jcmVhdGUobnVsbCk7XG4gXHRcdF9fd2VicGFja19yZXF1aXJlX18ucihucyk7XG4gXHRcdE9iamVjdC5kZWZpbmVQcm9wZXJ0eShucywgJ2RlZmF1bHQnLCB7IGVudW1lcmFibGU6IHRydWUsIHZhbHVlOiB2YWx1ZSB9KTtcbiBcdFx0aWYobW9kZSAmIDIgJiYgdHlwZW9mIHZhbHVlICE9ICdzdHJpbmcnKSBmb3IodmFyIGtleSBpbiB2YWx1ZSkgX193ZWJwYWNrX3JlcXVpcmVfXy5kKG5zLCBrZXksIGZ1bmN0aW9uKGtleSkgeyByZXR1cm4gdmFsdWVba2V5XTsgfS5iaW5kKG51bGwsIGtleSkpO1xuIFx0XHRyZXR1cm4gbnM7XG4gXHR9O1xuXG4gXHQvLyBnZXREZWZhdWx0RXhwb3J0IGZ1bmN0aW9uIGZvciBjb21wYXRpYmlsaXR5IHdpdGggbm9uLWhhcm1vbnkgbW9kdWxlc1xuIFx0X193ZWJwYWNrX3JlcXVpcmVfXy5uID0gZnVuY3Rpb24obW9kdWxlKSB7XG4gXHRcdHZhciBnZXR0ZXIgPSBtb2R1bGUgJiYgbW9kdWxlLl9fZXNNb2R1bGUgP1xuIFx0XHRcdGZ1bmN0aW9uIGdldERlZmF1bHQoKSB7IHJldHVybiBtb2R1bGVbJ2RlZmF1bHQnXTsgfSA6XG4gXHRcdFx0ZnVuY3Rpb24gZ2V0TW9kdWxlRXhwb3J0cygpIHsgcmV0dXJuIG1vZHVsZTsgfTtcbiBcdFx0X193ZWJwYWNrX3JlcXVpcmVfXy5kKGdldHRlciwgJ2EnLCBnZXR0ZXIpO1xuIFx0XHRyZXR1cm4gZ2V0dGVyO1xuIFx0fTtcblxuIFx0Ly8gT2JqZWN0LnByb3RvdHlwZS5oYXNPd25Qcm9wZXJ0eS5jYWxsXG4gXHRfX3dlYnBhY2tfcmVxdWlyZV9fLm8gPSBmdW5jdGlvbihvYmplY3QsIHByb3BlcnR5KSB7IHJldHVybiBPYmplY3QucHJvdG90eXBlLmhhc093blByb3BlcnR5LmNhbGwob2JqZWN0LCBwcm9wZXJ0eSk7IH07XG5cbiBcdC8vIF9fd2VicGFja19wdWJsaWNfcGF0aF9fXG4gXHRfX3dlYnBhY2tfcmVxdWlyZV9fLnAgPSBcIlwiO1xuXG5cbiBcdC8vIExvYWQgZW50cnkgbW9kdWxlIGFuZCByZXR1cm4gZXhwb3J0c1xuIFx0cmV0dXJuIF9fd2VicGFja19yZXF1aXJlX18oX193ZWJwYWNrX3JlcXVpcmVfXy5zID0gMSk7XG4iLCJtb2R1bGUuZXhwb3J0cyA9IHJlcXVpcmUoXCJkb21haW5cIik7IiwiaW1wb3J0IHtjcmVhdGVTZXJ2ZXJSZW5kZXJlcn0gZnJvbSAnYXNwbmV0LXByZXJlbmRlcmluZyc7XHJcblxyXG5leHBvcnQgZGVmYXVsdCBjcmVhdGVTZXJ2ZXJSZW5kZXJlcihmdW5jdGlvbihwYXJhbXMpe1xyXG4gICAgcmV0dXJuIG5ldyBQcm9taXNlKGZ1bmN0aW9uKHJlc29sdmUscmVqZWN0KXtcclxuICAgICAgICB2YXIgcmVzdWx0ID0gYDxoMT5UaGlzIGlzIHJlbmRlcmVkIGZyb20gc2VydmVyPC9oMT5cclxuICAgICAgICAgICAgICAgICAgICAgPGRpdj5DdXJyZW50IHRpbWU6JHtuZXcgRGF0ZSgpfTwvZGl2PlxyXG4gICAgICAgICAgICAgICAgICAgICA8ZGl2PlVSTDoke3BhcmFtcy5sb2NhdGlvbi5wYXRofTwvZGl2PlxyXG4gICAgICAgICAgICAgICAgICAgICA8ZGl2PklzQWRtaW5pc3RyYXRvcjoke3BhcmFtcy5kYXRhLmlzQWRtaW5pc3RyYXRvcn08L2Rpdj5cclxuICAgICAgICAgICAgICAgICAgICAgPGRpdj5OdW1iZXIgb2YgQ29va2llczoke3BhcmFtcy5kYXRhLmNvb2tpZXMubGVuZ3RofTwvZGl2PlxyXG4gICAgICAgICAgICAgICAgYDtcclxuICAgICAgICByZXNvbHZlKHtcclxuICAgICAgICAgICAgaHRtbDpyZXN1bHRcclxuICAgICAgICB9KTtcclxuICAgIH0pXHJcbn0pIiwiXCJ1c2Ugc3RyaWN0XCI7XHJcbmZ1bmN0aW9uIF9fZXhwb3J0KG0pIHtcclxuICAgIGZvciAodmFyIHAgaW4gbSkgaWYgKCFleHBvcnRzLmhhc093blByb3BlcnR5KHApKSBleHBvcnRzW3BdID0gbVtwXTtcclxufVxyXG5PYmplY3QuZGVmaW5lUHJvcGVydHkoZXhwb3J0cywgXCJfX2VzTW9kdWxlXCIsIHsgdmFsdWU6IHRydWUgfSk7XHJcbl9fZXhwb3J0KHJlcXVpcmUoXCIuL1ByZXJlbmRlcmluZ1wiKSk7XHJcbiIsIlwidXNlIHN0cmljdFwiO1xyXG5PYmplY3QuZGVmaW5lUHJvcGVydHkoZXhwb3J0cywgXCJfX2VzTW9kdWxlXCIsIHsgdmFsdWU6IHRydWUgfSk7XHJcbnZhciB1cmwgPSByZXF1aXJlKFwidXJsXCIpO1xyXG52YXIgZG9tYWluID0gcmVxdWlyZShcImRvbWFpblwiKTtcclxudmFyIG1haW5fMSA9IHJlcXVpcmUoXCJkb21haW4tdGFzay9tYWluXCIpO1xyXG52YXIgZGVmYXVsdFRpbWVvdXRNaWxsaXNlY29uZHMgPSAzMCAqIDEwMDA7XHJcbmZ1bmN0aW9uIGNyZWF0ZVNlcnZlclJlbmRlcmVyKGJvb3RGdW5jKSB7XHJcbiAgICB2YXIgcmVzdWx0RnVuYyA9IGZ1bmN0aW9uIChjYWxsYmFjaywgYXBwbGljYXRpb25CYXNlUGF0aCwgYm9vdE1vZHVsZSwgYWJzb2x1dGVSZXF1ZXN0VXJsLCByZXF1ZXN0UGF0aEFuZFF1ZXJ5LCBjdXN0b21EYXRhUGFyYW1ldGVyLCBvdmVycmlkZVRpbWVvdXRNaWxsaXNlY29uZHMsIHJlcXVlc3RQYXRoQmFzZSkge1xyXG4gICAgICAgIC8vIFByZXBhcmUgYSBwcm9taXNlIHRoYXQgd2lsbCByZXByZXNlbnQgdGhlIGNvbXBsZXRpb24gb2YgYWxsIGRvbWFpbiB0YXNrcyBpbiB0aGlzIGV4ZWN1dGlvbiBjb250ZXh0LlxyXG4gICAgICAgIC8vIFRoZSBib290IGNvZGUgd2lsbCB3YWl0IGZvciB0aGlzIGJlZm9yZSBwZXJmb3JtaW5nIGl0cyBmaW5hbCByZW5kZXIuXHJcbiAgICAgICAgdmFyIGRvbWFpblRhc2tDb21wbGV0aW9uUHJvbWlzZVJlc29sdmU7XHJcbiAgICAgICAgdmFyIGRvbWFpblRhc2tDb21wbGV0aW9uUHJvbWlzZSA9IG5ldyBQcm9taXNlKGZ1bmN0aW9uIChyZXNvbHZlLCByZWplY3QpIHtcclxuICAgICAgICAgICAgZG9tYWluVGFza0NvbXBsZXRpb25Qcm9taXNlUmVzb2x2ZSA9IHJlc29sdmU7XHJcbiAgICAgICAgfSk7XHJcbiAgICAgICAgdmFyIHBhcnNlZEFic29sdXRlUmVxdWVzdFVybCA9IHVybC5wYXJzZShhYnNvbHV0ZVJlcXVlc3RVcmwpO1xyXG4gICAgICAgIHZhciBwYXJhbXMgPSB7XHJcbiAgICAgICAgICAgIC8vIEl0J3MgaGVscGZ1bCBmb3IgYm9vdCBmdW5jcyB0byByZWNlaXZlIHRoZSBxdWVyeSBhcyBhIGtleS12YWx1ZSBvYmplY3QsIHNvIHBhcnNlIGl0IGhlcmVcclxuICAgICAgICAgICAgLy8gZS5nLiwgcmVhY3QtcmVkdXgtcm91dGVyIHJlcXVpcmVzIGxvY2F0aW9uLnF1ZXJ5IHRvIGJlIGEga2V5LXZhbHVlIG9iamVjdCBmb3IgY29uc2lzdGVuY3kgd2l0aCBjbGllbnQtc2lkZSBiZWhhdmlvdXJcclxuICAgICAgICAgICAgbG9jYXRpb246IHVybC5wYXJzZShyZXF1ZXN0UGF0aEFuZFF1ZXJ5LCAvKiBwYXJzZVF1ZXJ5U3RyaW5nICovIHRydWUpLFxyXG4gICAgICAgICAgICBvcmlnaW46IHBhcnNlZEFic29sdXRlUmVxdWVzdFVybC5wcm90b2NvbCArICcvLycgKyBwYXJzZWRBYnNvbHV0ZVJlcXVlc3RVcmwuaG9zdCxcclxuICAgICAgICAgICAgdXJsOiByZXF1ZXN0UGF0aEFuZFF1ZXJ5LFxyXG4gICAgICAgICAgICBiYXNlVXJsOiAocmVxdWVzdFBhdGhCYXNlIHx8ICcnKSArICcvJyxcclxuICAgICAgICAgICAgYWJzb2x1dGVVcmw6IGFic29sdXRlUmVxdWVzdFVybCxcclxuICAgICAgICAgICAgZG9tYWluVGFza3M6IGRvbWFpblRhc2tDb21wbGV0aW9uUHJvbWlzZSxcclxuICAgICAgICAgICAgZGF0YTogY3VzdG9tRGF0YVBhcmFtZXRlclxyXG4gICAgICAgIH07XHJcbiAgICAgICAgdmFyIGFic29sdXRlQmFzZVVybCA9IHBhcmFtcy5vcmlnaW4gKyBwYXJhbXMuYmFzZVVybDsgLy8gU2hvdWxkIGJlIHNhbWUgdmFsdWUgYXMgcGFnZSdzIDxiYXNlIGhyZWY+XHJcbiAgICAgICAgLy8gT3BlbiBhIG5ldyBkb21haW4gdGhhdCBjYW4gdHJhY2sgYWxsIHRoZSBhc3luYyB0YXNrcyBpbnZvbHZlZCBpbiB0aGUgYXBwJ3MgZXhlY3V0aW9uXHJcbiAgICAgICAgbWFpbl8xLnJ1bigvKiBjb2RlIHRvIHJ1biAqLyBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgICAgIC8vIFdvcmthcm91bmQgZm9yIE5vZGUgYnVnIHdoZXJlIG5hdGl2ZSBQcm9taXNlIGNvbnRpbnVhdGlvbnMgbG9zZSB0aGVpciBkb21haW4gY29udGV4dFxyXG4gICAgICAgICAgICAvLyAoaHR0cHM6Ly9naXRodWIuY29tL25vZGVqcy9ub2RlLXYwLngtYXJjaGl2ZS9pc3N1ZXMvODY0OClcclxuICAgICAgICAgICAgLy8gVGhlIGRvbWFpbi5hY3RpdmUgcHJvcGVydHkgaXMgc2V0IGJ5IHRoZSBkb21haW4tY29udGV4dCBtb2R1bGVcclxuICAgICAgICAgICAgYmluZFByb21pc2VDb250aW51YXRpb25zVG9Eb21haW4oZG9tYWluVGFza0NvbXBsZXRpb25Qcm9taXNlLCBkb21haW5bJ2FjdGl2ZSddKTtcclxuICAgICAgICAgICAgLy8gTWFrZSB0aGUgYmFzZSBVUkwgYXZhaWxhYmxlIHRvIHRoZSAnZG9tYWluLXRhc2tzL2ZldGNoJyBoZWxwZXIgd2l0aGluIHRoaXMgZXhlY3V0aW9uIGNvbnRleHRcclxuICAgICAgICAgICAgbWFpbl8xLmJhc2VVcmwoYWJzb2x1dGVCYXNlVXJsKTtcclxuICAgICAgICAgICAgLy8gQmVnaW4gcmVuZGVyaW5nLCBhbmQgYXBwbHkgYSB0aW1lb3V0XHJcbiAgICAgICAgICAgIHZhciBib290RnVuY1Byb21pc2UgPSBib290RnVuYyhwYXJhbXMpO1xyXG4gICAgICAgICAgICBpZiAoIWJvb3RGdW5jUHJvbWlzZSB8fCB0eXBlb2YgYm9vdEZ1bmNQcm9taXNlLnRoZW4gIT09ICdmdW5jdGlvbicpIHtcclxuICAgICAgICAgICAgICAgIGNhbGxiYWNrKFwiUHJlcmVuZGVyaW5nIGZhaWxlZCBiZWNhdXNlIHRoZSBib290IGZ1bmN0aW9uIGluIFwiICsgYm9vdE1vZHVsZS5tb2R1bGVOYW1lICsgXCIgZGlkIG5vdCByZXR1cm4gYSBwcm9taXNlLlwiLCBudWxsKTtcclxuICAgICAgICAgICAgICAgIHJldHVybjtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB2YXIgdGltZW91dE1pbGxpc2Vjb25kcyA9IG92ZXJyaWRlVGltZW91dE1pbGxpc2Vjb25kcyB8fCBkZWZhdWx0VGltZW91dE1pbGxpc2Vjb25kczsgLy8gZS5nLiwgcGFzcyAtMSB0byBvdmVycmlkZSBhcyAnbmV2ZXIgdGltZSBvdXQnXHJcbiAgICAgICAgICAgIHZhciBib290RnVuY1Byb21pc2VXaXRoVGltZW91dCA9IHRpbWVvdXRNaWxsaXNlY29uZHMgPiAwXHJcbiAgICAgICAgICAgICAgICA/IHdyYXBXaXRoVGltZW91dChib290RnVuY1Byb21pc2UsIHRpbWVvdXRNaWxsaXNlY29uZHMsIFwiUHJlcmVuZGVyaW5nIHRpbWVkIG91dCBhZnRlciBcIiArIHRpbWVvdXRNaWxsaXNlY29uZHMgKyBcIm1zIGJlY2F1c2UgdGhlIGJvb3QgZnVuY3Rpb24gaW4gJ1wiICsgYm9vdE1vZHVsZS5tb2R1bGVOYW1lICsgXCInIFwiXHJcbiAgICAgICAgICAgICAgICAgICAgKyAncmV0dXJuZWQgYSBwcm9taXNlIHRoYXQgZGlkIG5vdCByZXNvbHZlIG9yIHJlamVjdC4gTWFrZSBzdXJlIHRoYXQgeW91ciBib290IGZ1bmN0aW9uIGFsd2F5cyByZXNvbHZlcyBvciAnXHJcbiAgICAgICAgICAgICAgICAgICAgKyAncmVqZWN0cyBpdHMgcHJvbWlzZS4gWW91IGNhbiBjaGFuZ2UgdGhlIHRpbWVvdXQgdmFsdWUgdXNpbmcgdGhlIFxcJ2FzcC1wcmVyZW5kZXItdGltZW91dFxcJyB0YWcgaGVscGVyLicpXHJcbiAgICAgICAgICAgICAgICA6IGJvb3RGdW5jUHJvbWlzZTtcclxuICAgICAgICAgICAgLy8gQWN0dWFsbHkgcGVyZm9ybSB0aGUgcmVuZGVyaW5nXHJcbiAgICAgICAgICAgIGJvb3RGdW5jUHJvbWlzZVdpdGhUaW1lb3V0LnRoZW4oZnVuY3Rpb24gKHN1Y2Nlc3NSZXN1bHQpIHtcclxuICAgICAgICAgICAgICAgIGNhbGxiYWNrKG51bGwsIHN1Y2Nlc3NSZXN1bHQpO1xyXG4gICAgICAgICAgICB9LCBmdW5jdGlvbiAoZXJyb3IpIHtcclxuICAgICAgICAgICAgICAgIGNhbGxiYWNrKGVycm9yLCBudWxsKTtcclxuICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgfSwgLyogY29tcGxldGlvbiBjYWxsYmFjayAqLyBmdW5jdGlvbiAoLyogY29tcGxldGlvbiBjYWxsYmFjayAqLyBlcnJvck9yTm90aGluZykge1xyXG4gICAgICAgICAgICBpZiAoZXJyb3JPck5vdGhpbmcpIHtcclxuICAgICAgICAgICAgICAgIGNhbGxiYWNrKGVycm9yT3JOb3RoaW5nLCBudWxsKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICBlbHNlIHtcclxuICAgICAgICAgICAgICAgIC8vIFRoZXJlIGFyZSBubyBtb3JlIG9uZ29pbmcgZG9tYWluIHRhc2tzICh0eXBpY2FsbHkgZGF0YSBhY2Nlc3Mgb3BlcmF0aW9ucyksIHNvIHdlIGNhbiByZXNvbHZlXHJcbiAgICAgICAgICAgICAgICAvLyB0aGUgZG9tYWluIHRhc2tzIHByb21pc2Ugd2hpY2ggbm90aWZpZXMgdGhlIGJvb3QgY29kZSB0aGF0IGl0IGNhbiBkbyBpdHMgZmluYWwgcmVuZGVyLlxyXG4gICAgICAgICAgICAgICAgZG9tYWluVGFza0NvbXBsZXRpb25Qcm9taXNlUmVzb2x2ZSgpO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfSk7XHJcbiAgICB9O1xyXG4gICAgLy8gSW5kaWNhdGUgdG8gdGhlIHByZXJlbmRlcmluZyBjb2RlIGJ1bmRsZWQgaW50byBNaWNyb3NvZnQuQXNwTmV0Q29yZS5TcGFTZXJ2aWNlcyB0aGF0IHRoaXMgaXMgYSBzZXJ2ZXJzaWRlIHJlbmRlcmluZ1xyXG4gICAgLy8gZnVuY3Rpb24sIHNvIGl0IGNhbiBiZSBpbnZva2VkIGRpcmVjdGx5LiBUaGlzIGZsYWcgZXhpc3RzIG9ubHkgc28gdGhhdCwgaW4gaXRzIGFic2VuY2UsIHdlIGNhbiBydW4gc29tZSBkaWZmZXJlbnRcclxuICAgIC8vIGJhY2t3YXJkLWNvbXBhdGliaWxpdHkgbG9naWMuXHJcbiAgICByZXN1bHRGdW5jWydpc1NlcnZlclJlbmRlcmVyJ10gPSB0cnVlO1xyXG4gICAgcmV0dXJuIHJlc3VsdEZ1bmM7XHJcbn1cclxuZXhwb3J0cy5jcmVhdGVTZXJ2ZXJSZW5kZXJlciA9IGNyZWF0ZVNlcnZlclJlbmRlcmVyO1xyXG5mdW5jdGlvbiB3cmFwV2l0aFRpbWVvdXQocHJvbWlzZSwgdGltZW91dE1pbGxpc2Vjb25kcywgdGltZW91dFJlamVjdGlvblZhbHVlKSB7XHJcbiAgICByZXR1cm4gbmV3IFByb21pc2UoZnVuY3Rpb24gKHJlc29sdmUsIHJlamVjdCkge1xyXG4gICAgICAgIHZhciB0aW1lb3V0VGltZXIgPSBzZXRUaW1lb3V0KGZ1bmN0aW9uICgpIHtcclxuICAgICAgICAgICAgcmVqZWN0KHRpbWVvdXRSZWplY3Rpb25WYWx1ZSk7XHJcbiAgICAgICAgfSwgdGltZW91dE1pbGxpc2Vjb25kcyk7XHJcbiAgICAgICAgcHJvbWlzZS50aGVuKGZ1bmN0aW9uIChyZXNvbHZlZFZhbHVlKSB7XHJcbiAgICAgICAgICAgIGNsZWFyVGltZW91dCh0aW1lb3V0VGltZXIpO1xyXG4gICAgICAgICAgICByZXNvbHZlKHJlc29sdmVkVmFsdWUpO1xyXG4gICAgICAgIH0sIGZ1bmN0aW9uIChyZWplY3RlZFZhbHVlKSB7XHJcbiAgICAgICAgICAgIGNsZWFyVGltZW91dCh0aW1lb3V0VGltZXIpO1xyXG4gICAgICAgICAgICByZWplY3QocmVqZWN0ZWRWYWx1ZSk7XHJcbiAgICAgICAgfSk7XHJcbiAgICB9KTtcclxufVxyXG5mdW5jdGlvbiBiaW5kUHJvbWlzZUNvbnRpbnVhdGlvbnNUb0RvbWFpbihwcm9taXNlLCBkb21haW5JbnN0YW5jZSkge1xyXG4gICAgdmFyIG9yaWdpbmFsVGhlbiA9IHByb21pc2UudGhlbjtcclxuICAgIHByb21pc2UudGhlbiA9IChmdW5jdGlvbiB0aGVuKHJlc29sdmUsIHJlamVjdCkge1xyXG4gICAgICAgIGlmICh0eXBlb2YgcmVzb2x2ZSA9PT0gJ2Z1bmN0aW9uJykge1xyXG4gICAgICAgICAgICByZXNvbHZlID0gZG9tYWluSW5zdGFuY2UuYmluZChyZXNvbHZlKTtcclxuICAgICAgICB9XHJcbiAgICAgICAgaWYgKHR5cGVvZiByZWplY3QgPT09ICdmdW5jdGlvbicpIHtcclxuICAgICAgICAgICAgcmVqZWN0ID0gZG9tYWluSW5zdGFuY2UuYmluZChyZWplY3QpO1xyXG4gICAgICAgIH1cclxuICAgICAgICByZXR1cm4gb3JpZ2luYWxUaGVuLmNhbGwodGhpcywgcmVzb2x2ZSwgcmVqZWN0KTtcclxuICAgIH0pO1xyXG59XHJcbiIsIm1vZHVsZS5leHBvcnRzID0gcmVxdWlyZShcInVybFwiKTsiLCJcInVzZSBzdHJpY3RcIjtcclxuT2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsIFwiX19lc01vZHVsZVwiLCB7IHZhbHVlOiB0cnVlIH0pO1xyXG52YXIgZG9tYWluID0gcmVxdWlyZShcImRvbWFpblwiKTtcclxudmFyIGRvbWFpbkNvbnRleHQgPSByZXF1aXJlKFwiZG9tYWluLWNvbnRleHRcIik7XHJcbi8vIE5vdCB1c2luZyBzeW1ib2xzLCBiZWNhdXNlIHRoaXMgbWF5IG5lZWQgdG8gcnVuIGluIGEgdmVyc2lvbiBvZiBOb2RlLmpzIHRoYXQgZG9lc24ndCBzdXBwb3J0IHRoZW1cclxudmFyIGRvbWFpblRhc2tzU3RhdGVLZXkgPSAnX19ET01BSU5fVEFTS1MnO1xyXG52YXIgZG9tYWluVGFza0Jhc2VVcmxTdGF0ZUtleSA9ICdfX0RPTUFJTl9UQVNLX0lOVEVSTkFMX0ZFVENIX0JBU0VVUkxfX0RPX05PVF9SRUZFUkVOQ0VfVEhJU19fJztcclxudmFyIG5vRG9tYWluQmFzZVVybDtcclxuZnVuY3Rpb24gYWRkVGFzayh0YXNrKSB7XHJcbiAgICBpZiAodGFzayAmJiBkb21haW4uYWN0aXZlKSB7XHJcbiAgICAgICAgdmFyIHN0YXRlXzEgPSBkb21haW5Db250ZXh0LmdldChkb21haW5UYXNrc1N0YXRlS2V5KTtcclxuICAgICAgICBpZiAoc3RhdGVfMSkge1xyXG4gICAgICAgICAgICBzdGF0ZV8xLm51bVJlbWFpbmluZ1Rhc2tzKys7XHJcbiAgICAgICAgICAgIHRhc2sudGhlbihmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgICAgICAgICAvLyBUaGUgYXBwbGljYXRpb24gbWF5IGhhdmUgb3RoZXIgbGlzdGVuZXJzIGNoYWluZWQgdG8gdGhpcyBwcm9taXNlICphZnRlcipcclxuICAgICAgICAgICAgICAgIC8vIHRoaXMgbGlzdGVuZXIsIHdoaWNoIG1heSBpbiB0dXJuIHJlZ2lzdGVyIGZ1cnRoZXIgdGFza3MuIFNpbmNlIHdlIGRvbid0IFxyXG4gICAgICAgICAgICAgICAgLy8gd2FudCB0aGUgY29tYmluZWQgdGFzayB0byBjb21wbGV0ZSB1bnRpbCBhbGwgdGhlIGhhbmRsZXJzIGZvciBjaGlsZCB0YXNrc1xyXG4gICAgICAgICAgICAgICAgLy8gaGF2ZSBmaW5pc2hlZCwgZGVsYXkgdGhlIHJlc3BvbnNlIHRvIGdpdmUgdGltZSBmb3IgbW9yZSB0YXNrcyB0byBiZSBhZGRlZFxyXG4gICAgICAgICAgICAgICAgLy8gc3luY2hyb25vdXNseS5cclxuICAgICAgICAgICAgICAgIHNldFRpbWVvdXQoZnVuY3Rpb24gKCkge1xyXG4gICAgICAgICAgICAgICAgICAgIHN0YXRlXzEubnVtUmVtYWluaW5nVGFza3MtLTtcclxuICAgICAgICAgICAgICAgICAgICBpZiAoc3RhdGVfMS5udW1SZW1haW5pbmdUYXNrcyA9PT0gMCAmJiAhc3RhdGVfMS5oYXNJc3N1ZWRTdWNjZXNzQ2FsbGJhY2spIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgc3RhdGVfMS5oYXNJc3N1ZWRTdWNjZXNzQ2FsbGJhY2sgPSB0cnVlO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBzZXRUaW1lb3V0KGZ1bmN0aW9uICgpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHN0YXRlXzEuY29tcGxldGlvbkNhbGxiYWNrKC8qIGVycm9yICovIG51bGwpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB9LCAwKTtcclxuICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICB9LCAwKTtcclxuICAgICAgICAgICAgfSwgZnVuY3Rpb24gKGVycm9yKSB7XHJcbiAgICAgICAgICAgICAgICBzdGF0ZV8xLmNvbXBsZXRpb25DYWxsYmFjayhlcnJvcik7XHJcbiAgICAgICAgICAgIH0pO1xyXG4gICAgICAgIH1cclxuICAgIH1cclxufVxyXG5leHBvcnRzLmFkZFRhc2sgPSBhZGRUYXNrO1xyXG5mdW5jdGlvbiBydW4oY29kZVRvUnVuLCBjb21wbGV0aW9uQ2FsbGJhY2spIHtcclxuICAgIHZhciBzeW5jaHJvbm91c1Jlc3VsdDtcclxuICAgIGRvbWFpbkNvbnRleHQucnVuSW5OZXdEb21haW4oZnVuY3Rpb24gKCkge1xyXG4gICAgICAgIHZhciBzdGF0ZSA9IHtcclxuICAgICAgICAgICAgbnVtUmVtYWluaW5nVGFza3M6IDAsXHJcbiAgICAgICAgICAgIGhhc0lzc3VlZFN1Y2Nlc3NDYWxsYmFjazogZmFsc2UsXHJcbiAgICAgICAgICAgIGNvbXBsZXRpb25DYWxsYmFjazogZG9tYWluLmFjdGl2ZS5iaW5kKGNvbXBsZXRpb25DYWxsYmFjaylcclxuICAgICAgICB9O1xyXG4gICAgICAgIHRyeSB7XHJcbiAgICAgICAgICAgIGRvbWFpbkNvbnRleHQuc2V0KGRvbWFpblRhc2tzU3RhdGVLZXksIHN0YXRlKTtcclxuICAgICAgICAgICAgc3luY2hyb25vdXNSZXN1bHQgPSBjb2RlVG9SdW4oKTtcclxuICAgICAgICAgICAgLy8gSWYgbm8gdGFza3Mgd2VyZSByZWdpc3RlcmVkIHN5bmNocm9ub3VzbHksIHRoZW4gd2UncmUgZG9uZSBhbHJlYWR5XHJcbiAgICAgICAgICAgIGlmIChzdGF0ZS5udW1SZW1haW5pbmdUYXNrcyA9PT0gMCAmJiAhc3RhdGUuaGFzSXNzdWVkU3VjY2Vzc0NhbGxiYWNrKSB7XHJcbiAgICAgICAgICAgICAgICBzdGF0ZS5oYXNJc3N1ZWRTdWNjZXNzQ2FsbGJhY2sgPSB0cnVlO1xyXG4gICAgICAgICAgICAgICAgc2V0VGltZW91dChmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgc3RhdGUuY29tcGxldGlvbkNhbGxiYWNrKC8qIGVycm9yICovIG51bGwpO1xyXG4gICAgICAgICAgICAgICAgfSwgMCk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9XHJcbiAgICAgICAgY2F0Y2ggKGV4KSB7XHJcbiAgICAgICAgICAgIHN0YXRlLmNvbXBsZXRpb25DYWxsYmFjayhleCk7XHJcbiAgICAgICAgfVxyXG4gICAgfSk7XHJcbiAgICByZXR1cm4gc3luY2hyb25vdXNSZXN1bHQ7XHJcbn1cclxuZXhwb3J0cy5ydW4gPSBydW47XHJcbmZ1bmN0aW9uIGJhc2VVcmwodXJsKSB7XHJcbiAgICBpZiAodXJsKSB7XHJcbiAgICAgICAgaWYgKGRvbWFpbi5hY3RpdmUpIHtcclxuICAgICAgICAgICAgLy8gVGhlcmUncyBhbiBhY3RpdmUgZG9tYWluIChlLmcuLCBpbiBOb2RlLmpzKSwgc28gYXNzb2NpYXRlIHRoZSBiYXNlIFVSTCB3aXRoIGl0XHJcbiAgICAgICAgICAgIGRvbWFpbkNvbnRleHQuc2V0KGRvbWFpblRhc2tCYXNlVXJsU3RhdGVLZXksIHVybCk7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGVsc2Uge1xyXG4gICAgICAgICAgICAvLyBUaGVyZSdzIG5vIGFjdGl2ZSBkb21haW4gKGUuZy4sIGluIGJyb3dzZXIpLCBzbyB0aGVyZSdzIGp1c3Qgb25lIHNoYXJlZCBiYXNlIFVSTFxyXG4gICAgICAgICAgICBub0RvbWFpbkJhc2VVcmwgPSB1cmw7XHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG4gICAgcmV0dXJuIGRvbWFpbi5hY3RpdmUgPyBkb21haW5Db250ZXh0LmdldChkb21haW5UYXNrQmFzZVVybFN0YXRlS2V5KSA6IG5vRG9tYWluQmFzZVVybDtcclxufVxyXG5leHBvcnRzLmJhc2VVcmwgPSBiYXNlVXJsO1xyXG4iLCIvLyBHZW5lcmF0ZWQgYnkgQ29mZmVlU2NyaXB0IDEuNi4yXG52YXIgZG9tYWluO1xuXG5kb21haW4gPSByZXF1aXJlKCdkb21haW4nKTtcblxuZXhwb3J0cy5jb250ZXh0ID0gZnVuY3Rpb24oY29udGV4dCwgY3VycmVudERvbWFpbikge1xuICBpZiAoY3VycmVudERvbWFpbiA9PSBudWxsKSB7XG4gICAgY3VycmVudERvbWFpbiA9IGRvbWFpbi5hY3RpdmU7XG4gIH1cbiAgaWYgKGN1cnJlbnREb21haW4gPT0gbnVsbCkge1xuICAgIHRocm93IG5ldyBFcnJvcignbm8gYWN0aXZlIGRvbWFpbicpO1xuICB9XG4gIHJldHVybiBjdXJyZW50RG9tYWluLl9fY29udGV4dF9fID0gY29udGV4dCAhPSBudWxsID8gY29udGV4dCgpIDoge307XG59O1xuXG5leHBvcnRzLmNsZWFudXAgPSBmdW5jdGlvbihjbGVhbnVwLCBjb250ZXh0LCBjdXJyZW50RG9tYWluKSB7XG4gIGlmIChjb250ZXh0ID09IG51bGwpIHtcbiAgICBjb250ZXh0ID0gbnVsbDtcbiAgfVxuICBpZiAoY3VycmVudERvbWFpbiA9PSBudWxsKSB7XG4gICAgY3VycmVudERvbWFpbiA9IGRvbWFpbi5hY3RpdmU7XG4gIH1cbiAgY29udGV4dCA9IGNvbnRleHQgfHwgY3VycmVudERvbWFpbi5fX2NvbnRleHRfXztcbiAgaWYgKChjbGVhbnVwICE9IG51bGwpICYmIChjb250ZXh0ICE9IG51bGwpKSB7XG4gICAgY2xlYW51cChjb250ZXh0KTtcbiAgfVxuICBpZiAoY3VycmVudERvbWFpbiAhPSBudWxsKSB7XG4gICAgcmV0dXJuIGN1cnJlbnREb21haW4uX19jb250ZXh0X18gPSBudWxsO1xuICB9XG59O1xuXG5leHBvcnRzLm9uRXJyb3IgPSBmdW5jdGlvbihlcnIsIG9uRXJyb3IsIGNvbnRleHQsIGN1cnJlbnREb21haW4pIHtcbiAgaWYgKGNvbnRleHQgPT0gbnVsbCkge1xuICAgIGNvbnRleHQgPSBudWxsO1xuICB9XG4gIGlmIChjdXJyZW50RG9tYWluID09IG51bGwpIHtcbiAgICBjdXJyZW50RG9tYWluID0gZG9tYWluLmFjdGl2ZTtcbiAgfVxuICBjb250ZXh0ID0gY29udGV4dCB8fCBjdXJyZW50RG9tYWluLl9fY29udGV4dF9fO1xuICBpZiAob25FcnJvciAhPSBudWxsKSB7XG4gICAgb25FcnJvcihlcnIsIGNvbnRleHQpO1xuICB9XG4gIHJldHVybiBjdXJyZW50RG9tYWluLl9fY29udGV4dF9fID0gbnVsbDtcbn07XG5cbmV4cG9ydHMuZ2V0ID0gZnVuY3Rpb24oa2V5LCBjdXJyZW50RG9tYWluKSB7XG4gIGlmIChjdXJyZW50RG9tYWluID09IG51bGwpIHtcbiAgICBjdXJyZW50RG9tYWluID0gZG9tYWluLmFjdGl2ZTtcbiAgfVxuICBpZiAoY3VycmVudERvbWFpbiA9PSBudWxsKSB7XG4gICAgdGhyb3cgbmV3IEVycm9yKCdubyBhY3RpdmUgZG9tYWluJyk7XG4gIH1cbiAgcmV0dXJuIGN1cnJlbnREb21haW4uX19jb250ZXh0X19ba2V5XTtcbn07XG5cbmV4cG9ydHMuc2V0ID0gZnVuY3Rpb24oa2V5LCB2YWx1ZSwgY3VycmVudERvbWFpbikge1xuICBpZiAoY3VycmVudERvbWFpbiA9PSBudWxsKSB7XG4gICAgY3VycmVudERvbWFpbiA9IGRvbWFpbi5hY3RpdmU7XG4gIH1cbiAgaWYgKGN1cnJlbnREb21haW4gPT0gbnVsbCkge1xuICAgIHRocm93IG5ldyBFcnJvcignbm8gYWN0aXZlIGRvbWFpbicpO1xuICB9XG4gIHJldHVybiBjdXJyZW50RG9tYWluLl9fY29udGV4dF9fW2tleV0gPSB2YWx1ZTtcbn07XG5cbmV4cG9ydHMucnVuID0gZnVuY3Rpb24ob3B0aW9ucywgZnVuYykge1xuICB2YXIgY2xlYW51cCwgY29udGV4dCwgY3VycmVudERvbWFpbiwgZXJyLCBvbkVycm9yO1xuXG4gIGlmICghZnVuYykge1xuICAgIGZ1bmMgPSBvcHRpb25zO1xuICAgIG9wdGlvbnMgPSB7fTtcbiAgfVxuICBjb250ZXh0ID0gb3B0aW9ucy5jb250ZXh0LCBjbGVhbnVwID0gb3B0aW9ucy5jbGVhbnVwLCBvbkVycm9yID0gb3B0aW9ucy5vbkVycm9yO1xuICBjdXJyZW50RG9tYWluID0gb3B0aW9ucy5kb21haW4gfHwgZG9tYWluLmFjdGl2ZTtcbiAgaWYgKCFjdXJyZW50RG9tYWluKSB7XG4gICAgdGhyb3cgbmV3IEVycm9yKCdubyBhY3RpdmUgZG9tYWluJyk7XG4gIH1cbiAgY3VycmVudERvbWFpbi5vbignZGlzcG9zZScsIGZ1bmN0aW9uKCkge1xuICAgIHJldHVybiBleHBvcnRzLmNsZWFudXAoY2xlYW51cCwgbnVsbCwgY3VycmVudERvbWFpbik7XG4gIH0pO1xuICBjdXJyZW50RG9tYWluLm9uKCdlcnJvcicsIGZ1bmN0aW9uKGVycikge1xuICAgIGlmIChvbkVycm9yICE9IG51bGwpIHtcbiAgICAgIHJldHVybiBleHBvcnRzLm9uRXJyb3IoZXJyLCBvbkVycm9yLCBudWxsLCBjdXJyZW50RG9tYWluKTtcbiAgICB9IGVsc2Uge1xuICAgICAgcmV0dXJuIGV4cG9ydHMuY2xlYW51cChjbGVhbnVwLCBudWxsLCBjdXJyZW50RG9tYWluKTtcbiAgICB9XG4gIH0pO1xuICBleHBvcnRzLmNvbnRleHQoY29udGV4dCwgY3VycmVudERvbWFpbik7XG4gIHRyeSB7XG4gICAgY3VycmVudERvbWFpbi5iaW5kKGZ1bmMsIHRydWUpKCk7XG4gIH0gY2F0Y2ggKF9lcnJvcikge1xuICAgIGVyciA9IF9lcnJvcjtcbiAgICBjdXJyZW50RG9tYWluLmVtaXQoJ2Vycm9yJywgZXJyKTtcbiAgfVxuICByZXR1cm4gY3VycmVudERvbWFpbjtcbn07XG5cbmV4cG9ydHMucnVuSW5OZXdEb21haW4gPSBmdW5jdGlvbihvcHRpb25zLCBmdW5jKSB7XG4gIHZhciBjdXJyZW50RG9tYWluO1xuXG4gIGlmICghZnVuYykge1xuICAgIGZ1bmMgPSBvcHRpb25zO1xuICAgIG9wdGlvbnMgPSB7fTtcbiAgfVxuICBjdXJyZW50RG9tYWluID0gZG9tYWluLmFjdGl2ZTtcbiAgb3B0aW9ucy5kb21haW4gPSBkb21haW4uY3JlYXRlKCk7XG4gIGlmICghb3B0aW9ucy5kZXRhY2ggJiYgY3VycmVudERvbWFpbikge1xuICAgIGN1cnJlbnREb21haW4uYWRkKG9wdGlvbnMuZG9tYWluKTtcbiAgICBvcHRpb25zLmRvbWFpbi5vbignZXJyb3InLCBmdW5jdGlvbihlcnIpIHtcbiAgICAgIHJldHVybiBjdXJyZW50RG9tYWluLmVtaXQoJ2Vycm9yJywgZXJyKTtcbiAgICB9KTtcbiAgICBjdXJyZW50RG9tYWluLm9uKCdkaXNwb3NlJywgZnVuY3Rpb24oKSB7XG4gICAgICByZXR1cm4gb3B0aW9ucy5kb21haW4uZGlzcG9zZSgpO1xuICAgIH0pO1xuICB9XG4gIHJldHVybiBleHBvcnRzLnJ1bihvcHRpb25zLCBmdW5jKTtcbn07XG5cbmV4cG9ydHMubWlkZGxld2FyZSA9IGZ1bmN0aW9uKGNvbnRleHQsIGNsZWFudXApIHtcbiAgcmV0dXJuIGZ1bmN0aW9uKHJlcSwgcmVzLCBuZXh0KSB7XG4gICAgdmFyIGN1cnJlbnREb21haW4sIF9yZWY7XG5cbiAgICBpZiAodHlwZW9mIGNvbnRleHQgIT09ICdmdW5jdGlvbicpIHtcbiAgICAgIF9yZWYgPSBjb250ZXh0LCBjb250ZXh0ID0gX3JlZi5jb250ZXh0LCBjbGVhbnVwID0gX3JlZi5jbGVhbnVwO1xuICAgIH1cbiAgICBjdXJyZW50RG9tYWluID0gZG9tYWluLmFjdGl2ZTtcbiAgICBleHBvcnRzLmNvbnRleHQoY29udGV4dCwgY3VycmVudERvbWFpbik7XG4gICAgcmVzLm9uKCdmaW5pc2gnLCBmdW5jdGlvbigpIHtcbiAgICAgIHJldHVybiBleHBvcnRzLmNsZWFudXAoY2xlYW51cCwgbnVsbCwgY3VycmVudERvbWFpbik7XG4gICAgfSk7XG4gICAgcmVxLl9fY29udGV4dF9fID0gY3VycmVudERvbWFpbi5fX2NvbnRleHRfXztcbiAgICByZXR1cm4gbmV4dCgpO1xuICB9O1xufTtcblxuZXhwb3J0cy5taWRkbGV3YXJlT25FcnJvciA9IGZ1bmN0aW9uKG9uRXJyb3IpIHtcbiAgcmV0dXJuIGZ1bmN0aW9uKGVyciwgcmVxLCByZXMsIG5leHQpIHtcbiAgICBpZiAodHlwZW9mIG9uRXJyb3IgIT09ICdmdW5jdGlvbicpIHtcbiAgICAgIG9uRXJyb3IgPSBvbkVycm9yLm9uRXJyb3I7XG4gICAgfVxuICAgIGlmIChvbkVycm9yICE9IG51bGwpIHtcbiAgICAgIGV4cG9ydHMub25FcnJvcihlcnIsIG9uRXJyb3IsIHJlcS5fX2NvbnRleHRfXyk7XG4gICAgfSBlbHNlIHtcbiAgICAgIGV4cG9ydHMuY2xlYW51cChvbkVycm9yLCByZXEuX19jb250ZXh0X18pO1xuICAgIH1cbiAgICByZXEuX19jb250ZXh0X18gPSBudWxsO1xuICAgIHJldHVybiBuZXh0KGVycik7XG4gIH07XG59O1xuIl0sInNvdXJjZVJvb3QiOiIifQ==